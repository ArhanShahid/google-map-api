<!doctype html>
<html>
<head>
    <meta charset="utf-8">
    <title>plotting routes</title>
    <script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=false"></script>
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.5.1/jquery.min.js"></script>
    <script type="text/javascript">


        var myRouter = {
            map_: null,
            directionsHelper_: null,

            stores: [
                {name: "P1", location: new google.maps.LatLng(24.886747933454497, 67.13865280151367)},
                {name: "P2", location: new google.maps.LatLng(24.887059375335962, 67.1290397644043)},
                {name: "P3", location: new google.maps.LatLng(24.882543391192204,  67.11376190185547)},
                {name: "P4", location: new google.maps.LatLng(24.874445351033874,  67.09659576416016)},
                {name: "P5", location: new google.maps.LatLng(24.86634678017567,  67.08337783813477)},
                {name: "P6", location: new google.maps.LatLng(24.858714949016232,  67.05780029296875)},
                {name: "P7", location: new google.maps.LatLng(24.854197929104103,  67.03702926635742)}
            ],

            calcRoute: function() {

                var waypts = [];

                for (var i in this.stores) {
                    waypts.push({
                        location: this.stores[i].location,
                        stopover:true
                    });
                }

                console.log("waypts");
                console.log(waypts);

                var request = {
                    origin: new google.maps.LatLng(24.886747933454497, 67.14895248413086),
                    destination: new google.maps.LatLng(24.846253804304137, 67.02518463134766),
                    waypoints: waypts,
                    optimizeWaypoints: true,
                    travelMode: google.maps.DirectionsTravelMode.DRIVING
                };

                console.log("request");
                console.log(request);

                var _SELF = this;
                this.directionsHelper_.route(request, function(response, status) {

                    console.log('Directions Status: ' + status);
                    console.log('Directions response:');
                    console.log(response);

                    if (status == google.maps.DirectionsStatus.OK) {
                        _SELF.directionsDisplay_.setDirections(response);
                        return;
                    }
                    console.log('Directions Status: ' + status);
                });
            },

            init: function(mapid) {

                this.directionsHelper_ = new google.maps.DirectionsService();
                this.directionsDisplay_ = new google.maps.DirectionsRenderer();

                var center = new google.maps.LatLng(50.82788, 3.26499);
                var myOptions = {
                    zoom:7,
                    mapTypeId: google.maps.MapTypeId.ROADMAP,
                    center: center
                };
                this.map_ = new google.maps.Map(document.getElementById(mapid), myOptions);
                this.directionsDisplay_.setMap(this.map_);

                this.calcRoute();
            }
        };

        $(document).ready(function() {
            myRouter.init('map');
        });

    </script>
    <style type="text/css">
        #map {
            height: 500px;
            width: 600px;
            border: 1px solid #000;
        }
    </style>
</head>
<body>
<div id="map"></div>
</body>
</html>